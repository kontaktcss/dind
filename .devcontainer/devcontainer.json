{
  "name": "Tailscale + Docker",

  "build": {
    "dockerfile": "Dockerfile"
  },

  "mounts": [
    "source=var-lib-docker,target=/var/lib/docker,type=volume"
  ],

  "forwardPorts": [
    22,
    8006
  ],

  "portsAttributes": {
    "22": {
      "label": "GitHub Codespaces (SSH)",
      "onAutoForward": "notify"
    },
    "8006": {
      "label": "Docker / HTTP",
      "onAutoForward": "notify"
    }
  },

  "capAdd": ["ALL"],
  "securityOpt": ["seccomp=unconfined"],

  "workspaceMount": "source=${localWorkspaceFolder},target=/workspaces/github,type=bind,consistency=cached",
  "workspaceFolder": "/workspaces/github",

  "onCreateCommand": "bash .devcontainer/onCreateCommand.sh",
  "postStartCommand": "bash .devcontainer/postStartCommand.sh",
  "postAttachCommand": "bash .devcontainer/postAttachCommand.sh",

  "waitFor": "postStartCommand"
}
